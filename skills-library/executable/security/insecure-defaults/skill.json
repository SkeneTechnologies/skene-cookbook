{
  "id": "security/insecure-defaults",
  "version": "1.0.0",
  "name": "insecure-defaults",
  "description": "\"Detects fail-open insecure defaults (hardcoded secrets, weak auth, permissive security) that allow apps to run insecurely in production. Use when auditing security, reviewing config management, or analyzing environment variable handling.\"",
  "domain": "security",
  "source": "external",
  "tools": [],
  "exitStates": [
    "success",
    "failure"
  ],
  "inputSchema": {
    "type": "object",
    "properties": {
      "target_paths": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "description": "Specific directories or files to audit (e.g., ['src/', 'config/', 'docker-compose.yml']). If empty, analyzes entire project.",
        "default": []
      },
      "exclude_patterns": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "description": "Patterns to exclude from analysis (e.g., ['test/', '*.example', 'docs/', '__tests__/', '*.sample'])",
        "default": [
          "test/",
          "tests/",
          "spec/",
          "__tests__/",
          "*.example",
          "*.template",
          "*.sample",
          "docs/",
          "README.md"
        ]
      },
      "severity_threshold": {
        "type": "string",
        "enum": [
          "LOW",
          "MEDIUM",
          "HIGH",
          "CRITICAL"
        ],
        "description": "Minimum severity level to report",
        "default": "MEDIUM"
      },
      "check_production_config": {
        "type": "boolean",
        "description": "Whether to verify production configuration files exist and contain secure values",
        "default": true
      },
      "custom_patterns": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string",
              "description": "Name of the custom pattern"
            },
            "pattern": {
              "type": "string",
              "description": "Regex pattern to search for"
            },
            "category": {
              "type": "string",
              "enum": [
                "fallback_secret",
                "hardcoded_credential",
                "weak_default",
                "weak_crypto",
                "permissive_access",
                "debug_feature"
              ],
              "description": "Category of the vulnerability"
            }
          },
          "required": [
            "name",
            "pattern",
            "category"
          ]
        },
        "description": "Additional custom patterns to search for beyond built-in patterns",
        "default": []
      }
    },
    "required": [],
    "additionalProperties": false
  },
  "outputSchema": {
    "type": "object",
    "properties": {
      "summary": {
        "type": "object",
        "properties": {
          "total_findings": {
            "type": "integer",
            "description": "Total number of insecure defaults detected",
            "minimum": 0
          },
          "critical_count": {
            "type": "integer",
            "description": "Number of critical severity findings",
            "minimum": 0
          },
          "high_count": {
            "type": "integer",
            "description": "Number of high severity findings",
            "minimum": 0
          },
          "medium_count": {
            "type": "integer",
            "description": "Number of medium severity findings",
            "minimum": 0
          },
          "low_count": {
            "type": "integer",
            "description": "Number of low severity findings",
            "minimum": 0
          },
          "project_type": {
            "type": "string",
            "description": "Detected project type/framework (e.g., 'Node.js/Express', 'Python/Django', 'Java/Spring')"
          }
        },
        "required": [
          "total_findings",
          "critical_count",
          "high_count",
          "medium_count",
          "low_count"
        ]
      },
      "findings": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string",
              "description": "Unique identifier for this finding"
            },
            "title": {
              "type": "string",
              "description": "Brief title describing the vulnerability"
            },
            "severity": {
              "type": "string",
              "enum": [
                "LOW",
                "MEDIUM",
                "HIGH",
                "CRITICAL"
              ],
              "description": "Severity level of the finding"
            },
            "category": {
              "type": "string",
              "enum": [
                "fallback_secret",
                "hardcoded_credential",
                "weak_default",
                "weak_crypto",
                "permissive_access",
                "debug_feature"
              ],
              "description": "Category of insecure default"
            },
            "location": {
              "type": "object",
              "properties": {
                "file": {
                  "type": "string",
                  "description": "File path where the issue was found"
                },
                "line": {
                  "type": "integer",
                  "description": "Line number where the issue occurs",
                  "minimum": 1
                },
                "column": {
                  "type": "integer",
                  "description": "Column number (if available)",
                  "minimum": 1
                }
              },
              "required": [
                "file",
                "line"
              ]
            },
            "pattern_matched": {
              "type": "string",
              "description": "The specific pattern or code snippet that triggered the detection"
            },
            "code_snippet": {
              "type": "string",
              "description": "Relevant code context showing the vulnerable code"
            },
            "behavior_analysis": {
              "type": "object",
              "properties": {
                "is_fail_open": {
                  "type": "boolean",
                  "description": "Whether this is fail-open (true) or fail-secure (false)"
                },
                "execution_context": {
                  "type": "string",
                  "description": "When this code executes (e.g., 'startup', 'runtime', 'on-request')"
                },
                "missing_config_behavior": {
                  "type": "string",
                  "description": "What happens when configuration is missing"
                }
              },
              "required": [
                "is_fail_open"
              ]
            },
            "production_impact": {
              "type": "object",
              "properties": {
                "reaches_production": {
                  "type": "boolean",
                  "description": "Whether this code path reaches production"
                },
                "production_config_exists": {
                  "type": "boolean",
                  "description": "Whether production configuration properly sets this value"
                },
                "exploitation_scenario": {
                  "type": "string",
                  "description": "How an attacker could exploit this vulnerability"
                }
              },
              "required": [
                "reaches_production"
              ]
            },
            "recommendation": {
              "type": "string",
              "description": "Specific remediation advice for this finding"
            },
            "references": {
              "type": "array",
              "items": {
                "type": "string",
                "format": "uri"
              },
              "description": "Links to relevant security guidelines or documentation"
            }
          },
          "required": [
            "id",
            "title",
            "severity",
            "category",
            "location",
            "pattern_matched",
            "code_snippet",
            "behavior_analysis",
            "production_impact",
            "recommendation"
          ]
        }
      },
      "scanned_files": {
        "type": "integer",
        "description": "Total number of files scanned",
        "minimum": 0
      },
      "excluded_files": {
        "type": "integer",
        "description": "Number of files excluded from scanning",
        "minimum": 0
      },
      "scan_duration_seconds": {
        "type": "number",
        "description": "Time taken to complete the scan",
        "minimum": 0
      }
    },
    "required": [
      "summary",
      "findings",
      "scanned_files"
    ]
  },
  "temperature": 0,
  "tags": [
    "security",
    "imported",
    "verified"
  ],
  "platforms": {
    "claude": {
      "triggers": [
        "help with insecure defaults",
        "security audit",
        "code security",
        "secure coding",
        "auditing security, reviewing config management, or analyzing environment variable handling"
      ]
    },
    "cursor": {},
    "skeneflow": {}
  },
  "security_controls": {
    "authentication": {
      "method": "oauth",
      "provider": "managed_identity",
      "scopes": [
        "read:data",
        "write:data"
      ],
      "token_lifetime": 3600
    }
  },
  "metadata": {
    "schemaGenerated": true,
    "schemaConfidence": 0.92
  }
}
